---
title: "Triangulizador"
author: "Galileo Cappella"
date: "September 27, 2018"
output: html_document
---

```{r}
MI <- matrix( #Matriz de identidad
  c(1, 0, 0, 0,
    0, 1, 0, 0,
    0, 0, 1, 0,
    0, 0, 0, 1),
  nrow = 4,
  ncol = 4,
  byrow = TRUE
)

MTestGen <- matrix( #Una para testear en general
  c(3, 9, 3, 12,
    5, 1, 4, 6,
    0, 3, 5, 10,
    8, 0, 1, 1),
  nrow = 4,
  ncol = 4,
  byrow = TRUE
)

MTestR4x5 <- matrix(
  c(3, 9, 3, 12, 8,
    5, 1, 4, 6, 17,
    0, 3, 5, 10, 7,
    8, 0, 1, 1, 9),
  nrow = 4,
  ncol = 5,
  byrow = TRUE
)
```

```{r}
#TODOS LOS PRINT ESTAN PARA DEBUGEAR

triangular <- function(mat) {
    print("Matriz inicial")
    print(mat)

  for(i in 1:NROW(mat)){
    print("i Nro")
    print(i)

    #Averigua el orden (decreciente) para la columna qe esta. Esto me asegura qe no haya un cero en el pivote (lo normalizo despues de ordenarlas).
    if(mat[i,i] != 1) {
    OrdenA <- order(mat[,i], decreasing = TRUE)
    OrdenC <- OrdenA[!OrdenA %in%  0:(i-1)] #Estaria bueno no usar el OrdenA, pero no se como hacer
    
    print("OrdenA")
    print(OrdenA)
    print("OrdenC")
    print(OrdenC)

    #Reorganiza las filas en base a las columnas qe todavia no triangulo.
    mat[i:NROW(mat),] <- mat[OrdenC,]
    
    print("Matrix:")
    print(mat)
    
    #Normaliza el pivote
    mat[i,] <- mat[i,] / mat[i,i]
    print("Normalizada:")
    print(mat)
  
    }
    #Qiero qe reste a las filas de la columna para volver cero a esta columna (excepto por el pivote).
    for(t in (i+1):NROW(mat)) {
      if(i<4) { #Con este if arreglo un problema boludo qe no me qise poner a arreglar.
        print("tAnt")
        print(mat[t,])
        print("Minus")
        print(mat[t,i] * mat[i,])
        mat[t,] <- mat[t,] - mat[t,i] * mat[i,] #A toda la fila le resta el primer valor
        
        print("tNew")
        print(mat[t,])
      }
    }
    print("Fin de este paso")
    print(mat)
  }

 print("Done")
 return(mat)
}

triangular(MTestR4x5)
```